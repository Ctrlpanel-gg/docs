"use strict";(self.webpackChunkctrlpanel=self.webpackChunkctrlpanel||[]).push([[3503],{1418:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"Installation/additional-configuration","title":"Additional Configuration","description":"Misc Configuration","source":"@site/versioned_docs/version-1.0.x/Installation/additional-configuration.md","sourceDirName":"Installation","slug":"/Installation/additional-configuration","permalink":"/docs/1.0.x/Installation/additional-configuration","draft":false,"unlisted":false,"editUrl":"https://github.com/Ctrlpanel-gg/docs/tree/main/versioned_docs/version-1.0.x/Installation/additional-configuration.md","tags":[],"version":"1.0.x","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Getting started","permalink":"/docs/1.0.x/Installation/getting-started"},"next":{"title":"Troubleshooting","permalink":"/docs/1.0.x/Installation/troubleshooting"}}');var i=t(4848),a=t(8453),r=t(4252);const s={sidebar_position:3},l="Additional Configuration",c={},d=[{value:"Misc Configuration",id:"misc-configuration",level:2},{value:"Setup Auth",id:"setup-auth",level:3},{value:"Setup Discord OAuth2",id:"setup-discord-oauth2",level:3},{value:"Creating a Storage Symlink",id:"creating-a-storage-symlink",level:3},{value:"reCAPTCHA",id:"recaptcha",level:3},{value:"Manual Mail Configuration",id:"manual-mail-configuration",level:3},{value:"Payment Configuration",id:"payment-configuration",level:3},{value:"PayPal",id:"paypal",level:4},{value:"Stripe",id:"stripe",level:4}];function u(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"additional-configuration",children:"Additional Configuration"})}),"\n","\n",(0,i.jsx)(r.A,{toc:d}),"\n",(0,i.jsx)(n.h2,{id:"misc-configuration",children:"Misc Configuration"}),"\n",(0,i.jsx)(n.h3,{id:"setup-auth",children:"Setup Auth"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"http://faq.demostoreprestashop.com/faq.php?fid=133&pid=41",children:"How"})," to get CLIENT_ID and CLIENT_SECRET ",(0,i.jsx)("br",{}),"\nfor the redirect URI, you have to use YOUR_WEBSITE_URL + /auth/callback (example: ",(0,i.jsx)(n.code,{children:"https://demo.ctrlpanel.gg/auth/callback"}),")"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Adding the Discord Bot"}),(0,i.jsx)("br",{}),"\nIf you would like to automatically force new users to join your Discord server after they have verified, you will need to set up a Discord bot. This can be an already existing Discord bot in your server. If your bot isn't in the server yet, add it by using this: ",(0,i.jsx)(n.code,{children:"https://discord.com/api/oauth2/authorize?client_id=<CLIENT_ID_HERE>&permissions=8&scope=bot"}),". Replace the ",(0,i.jsx)(n.code,{children:"<CLIENT_ID_HERE>"})," with your bots client ID."]}),"\n",(0,i.jsx)(n.h3,{id:"setup-discord-oauth2",children:"Setup Discord OAuth2"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Go to ",(0,i.jsx)(n.code,{children:"https://YOUR_DOMAIN_HERE/admin/settings#Discord"})," (replace ",(0,i.jsx)(n.code,{children:"YOUR_DOMAIN_HERE"})," with your dashboard domain)."]}),"\n",(0,i.jsxs)(n.li,{children:["In the Discord section, enter the following information:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Your bot's Token"}),"\n",(0,i.jsx)(n.li,{children:"Your bot's Client ID"}),"\n",(0,i.jsx)(n.li,{children:"Your bot's Client Secret"}),"\n",(0,i.jsx)(n.li,{children:"Your Discord Guild ID (optional, but useful if you want the user to be added to your server)"}),"\n",(0,i.jsx)(n.li,{children:"Your Discord Invite URL (optional, but useful if you want the user to be able to join into your server using the invitation link)"}),"\n",(0,i.jsx)(n.li,{children:"Your Discord Role ID (optional, but useful if you want the verified user to receive a role on your server after verification)"}),"\n",(0,i.jsx)(n.li,{children:"Your Discord Role ID on Purchase (optional, but useful if you want the user to get a role on your server after purchase)"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:'Finally, click the "Save" button to save the changes.'}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"That's it! The Dashboard can now use your bot to make API calls to Discord to place new users into your Discord server. Your bot will not come online as we only use it to make API calls when someone verifies, you can still use your bot as you normally would as it won't affect the bot itself."}),"\n",(0,i.jsx)(n.h3,{id:"creating-a-storage-symlink",children:"Creating a Storage Symlink"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.em,{children:["CtrlPanel requires a symbolic link to be created between the ",(0,i.jsx)(n.code,{children:"storage/app/public"})," directory and the ",(0,i.jsx)(n.code,{children:"public/storage"})," directory to properly serve uploaded files."]})}),"\n",(0,i.jsx)(n.p,{children:"To create this symlink, run the following command in the root of your CtrlPanel:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"php artisan storage:link\n"})}),"\n",(0,i.jsx)(n.h3,{id:"recaptcha",children:"reCAPTCHA"}),"\n",(0,i.jsxs)(n.p,{children:["Go to ",(0,i.jsx)(n.code,{children:"https://<your.ctrlpanel.gg>/admin/settings#General"})]}),"\n",(0,i.jsx)(n.p,{children:"Ctrlpanel uses reCAPTCHA to secure the login page from brute-force attacks. If the login attempt is considered suspicious, users may be required to perform a reCAPTCHA challenge."}),"\n",(0,i.jsxs)(n.p,{children:["You can generate your own keys in the ",(0,i.jsx)(n.a,{href:"https://www.google.com/recaptcha/admin/create",children:"admin console"})]}),"\n",(0,i.jsxs)(n.p,{children:["Go to the Admin Misc settings and change the ",(0,i.jsx)(n.code,{children:"reCAPTCHA Site Key"})," and ",(0,i.jsx)(n.code,{children:"reCAPTCHA Secret Key"}),". Once you've updated it, press ",(0,i.jsx)(n.code,{children:"Save"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"FAQ for reCAPTCHA"}),(0,i.jsx)("br",{})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Q:"})," It says ",(0,i.jsx)(n.code,{children:"ERROR for site owner: Invalid site key"})," ",(0,i.jsx)("br",{}),"\n",(0,i.jsx)(n.strong,{children:"A:"})," This means that you put in the incorrect site key. Double check you're using v2 and ",(0,i.jsx)(n.code,{children:"I'm not a robot"})," checkbox on the reCAPTCHA create page which is found ",(0,i.jsx)(n.a,{href:"https://www.google.com/recaptcha/admin/create",children:"here"})]}),"\n",(0,i.jsx)(n.h3,{id:"manual-mail-configuration",children:"Manual Mail Configuration"}),"\n",(0,i.jsxs)(n.p,{children:["To send out notifications and mails, you will need to configure your mail variables correctly.\nYou can use a free mail server; for example, from ",(0,i.jsx)(n.a,{href:"https://www.mailjet.com/",children:"Mailjet"}),". You can also install your own mail server using, for example, ",(0,i.jsx)(n.a,{href:"https://mailcow.email/",children:"Mailcow"})]}),"\n",(0,i.jsxs)(n.p,{children:["Go to ",(0,i.jsx)(n.code,{children:"https://<your.ctrlpanel.gg>/admin/settings#Mail"})," and enter your mail credentials that you recieved from whichever provider."]}),"\n",(0,i.jsx)(n.p,{children:"Once set run these 2 commands to ensure that emails work:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"php /var/www/ctrlpanel/artisan config:clear\nphp /var/www/ctrlpanel/artisan queue:restart\n"})}),"\n",(0,i.jsx)(n.p,{children:"To test the mail configuration, you can go to the Users tab and click the notify button top right.\nSelect a user and choose to send via email, write some text and click submit. It may take a few minutes until it's sent."}),"\n",(0,i.jsx)(n.h3,{id:"payment-configuration",children:"Payment Configuration"}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsx)(n.p,{children:"You are able to use Paypal, Stripe, Mollie and Mercadopago as a payment option. If you want to add a different form of payment that isn't covered by those you have to add it yourself."})}),"\n",(0,i.jsx)(n.h4,{id:"paypal",children:"PayPal"}),"\n",(0,i.jsxs)(n.p,{children:["To use the PayPal payment gateway, you have to set up an application on Paypal Developer Dashboard which you can find ",(0,i.jsx)(n.a,{href:"https://developer.paypal.com/developer/accounts/",children:"here"}),"."]}),"\n",(0,i.jsx)(n.p,{children:'To setup Paypal payments, go to "My Apps & Credentials" and choose either "Live" for production use or "Sandbox" for testing use of PayPal.'}),"\n",(0,i.jsx)(n.p,{children:"Create a app, give it any name you want, and copy the Client ID and the Secret. After go back to your Ctrlpanel setup and paste in the credientials into the Paypal section. If you have the Live mode on, put the Client ID and Secret in the first 2 boxes. If you have it on Sandbox, put it in the last 2 boxes."}),"\n",(0,i.jsx)(n.p,{children:'The only "App Feature Option" that Ctrlpanel needs is "Accept Payments".'}),"\n",(0,i.jsx)(n.h4,{id:"stripe",children:"Stripe"}),"\n",(0,i.jsxs)(n.p,{children:['To use Stripe as your payment gateway, you first have to setup a "company" on Stripe\'s dashboard which you can find ',(0,i.jsx)(n.a,{href:"https://dashboard.stripe.com/account/onboarding/business-structure",children:"here"})]}),"\n",(0,i.jsxs)(n.p,{children:["To setup Stripe, go to the Developer page and click on API Keys. You only need the Secret key in order to use Stripe as your payment gateway. Once you have the secret key go to your Ctrlpanel setup and paste the secret into the ",(0,i.jsx)(n.code,{children:"Stripe Secret Key"})," section."]}),"\n",(0,i.jsxs)(n.p,{children:["Now, you will need to setup a Stripe Webhook in order to accept payments that are not 100% instantly confirmed by stripe (Klarna, Bank-Transfer etc.).\nTo do so, click on Webhooks and add an endpoint.\nThe endpoint route would look something like this: ",(0,i.jsx)(n.code,{children:"https://<your.ctrlpanel.gg>/payment/StripeWebhooks"}),". Change the ",(0,i.jsx)(n.code,{children:"<your.ctrlpanel.gg>"})," to your Ctrlpanel setup link.\nChoose the ",(0,i.jsx)(n.code,{children:"payment_intent.succeded"})," event to be sent to your WebhookRoute.\nAfter the webhook creation, you need to get the endpoint secret and copy paste it to your Ctrlpanel payment settings. The endpoint secret can be found in the Webhook Overview page."]}),"\n",(0,i.jsxs)(n.p,{children:["In your Ctrlpanel setup, you need to provide a comma separated list of payment methods you want to support via Stripe. For example, ",(0,i.jsx)(n.code,{children:"card,sepa_debit"}),". This includes both card and SEPA debit cards that can be used to pay.\nTo see the list of avaliable payment options with Stripe, read their documentation which can be found ",(0,i.jsx)(n.a,{href:"https://docs.stripe.com/payments/payment-methods/payment-method-support",children:"here"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"Just like Paypal, you can change it from Live to Sandbox and vice-versa in case you want to test to make sure that your payments are working correctly."}),"\n",(0,i.jsxs)(n.p,{children:["Did something go wrong for you? We hope not, however it's very possible. If you need support, feel free to create a support thread on our ",(0,i.jsx)(n.a,{href:"https://discord.gg/ctrlpanel-gg-787829714483019826",children:"Discord"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}},4252:(e,n,t)=>{t.d(n,{A:()=>r});t(6540);var o=t(5195);const i={tableOfContentsInline:"tableOfContentsInline_prmo"};var a=t(4848);function r({toc:e,minHeadingLevel:n,maxHeadingLevel:t}){return(0,a.jsx)("div",{className:i.tableOfContentsInline,children:(0,a.jsx)(o.A,{toc:e,minHeadingLevel:n,maxHeadingLevel:t,className:"table-of-contents",linkClassName:null})})}},5195:(e,n,t)=>{t.d(n,{A:()=>f});var o=t(6540),i=t(6342);function a(e){const n=e.map(e=>({...e,parentIndex:-1,children:[]})),t=Array(7).fill(-1);n.forEach((e,n)=>{const o=t.slice(2,e.level);e.parentIndex=Math.max(...o),t[e.level]=n});const o=[];return n.forEach(e=>{const{parentIndex:t,...i}=e;t>=0?n[t].children.push(i):o.push(i)}),o}function r({toc:e,minHeadingLevel:n,maxHeadingLevel:t}){return e.flatMap(e=>{const o=r({toc:e.children,minHeadingLevel:n,maxHeadingLevel:t});return function(e){return e.level>=n&&e.level<=t}(e)?[{...e,children:o}]:o})}function s(e){const n=e.getBoundingClientRect();return n.top===n.bottom?s(e.parentNode):n}function l(e,{anchorTopOffset:n}){const t=e.find(e=>s(e).top>=n);if(t){return function(e){return e.top>0&&e.bottom<window.innerHeight/2}(s(t))?t:e[e.indexOf(t)-1]??null}return e[e.length-1]??null}function c(){const e=(0,o.useRef)(0),{navbar:{hideOnScroll:n}}=(0,i.p)();return(0,o.useEffect)(()=>{e.current=n?0:document.querySelector(".navbar").clientHeight},[n]),e}function d(e){const n=(0,o.useRef)(void 0),t=c();(0,o.useEffect)(()=>{if(!e)return()=>{};const{linkClassName:o,linkActiveClassName:i,minHeadingLevel:a,maxHeadingLevel:r}=e;function s(){const e=function(e){return Array.from(document.getElementsByClassName(e))}(o),s=function({minHeadingLevel:e,maxHeadingLevel:n}){const t=[];for(let o=e;o<=n;o+=1)t.push(`h${o}.anchor`);return Array.from(document.querySelectorAll(t.join()))}({minHeadingLevel:a,maxHeadingLevel:r}),c=l(s,{anchorTopOffset:t.current}),d=e.find(e=>c&&c.id===function(e){return decodeURIComponent(e.href.substring(e.href.indexOf("#")+1))}(e));e.forEach(e=>{!function(e,t){t?(n.current&&n.current!==e&&n.current.classList.remove(i),e.classList.add(i),n.current=e):e.classList.remove(i)}(e,e===d)})}return document.addEventListener("scroll",s),document.addEventListener("resize",s),s(),()=>{document.removeEventListener("scroll",s),document.removeEventListener("resize",s)}},[e,t])}var u=t(8774),h=t(4848);function p({toc:e,className:n,linkClassName:t,isChild:o}){return e.length?(0,h.jsx)("ul",{className:o?void 0:n,children:e.map(e=>(0,h.jsxs)("li",{children:[(0,h.jsx)(u.A,{to:`#${e.id}`,className:t??void 0,dangerouslySetInnerHTML:{__html:e.value}}),(0,h.jsx)(p,{isChild:!0,toc:e.children,className:n,linkClassName:t})]},e.id))}):null}const m=o.memo(p);function f({toc:e,className:n="table-of-contents table-of-contents__left-border",linkClassName:t="table-of-contents__link",linkActiveClassName:s,minHeadingLevel:l,maxHeadingLevel:c,...u}){const p=(0,i.p)(),f=l??p.tableOfContents.minHeadingLevel,g=c??p.tableOfContents.maxHeadingLevel,y=function({toc:e,minHeadingLevel:n,maxHeadingLevel:t}){return(0,o.useMemo)(()=>r({toc:a(e),minHeadingLevel:n,maxHeadingLevel:t}),[e,n,t])}({toc:e,minHeadingLevel:f,maxHeadingLevel:g});return d((0,o.useMemo)(()=>{if(t&&s)return{linkClassName:t,linkActiveClassName:s,minHeadingLevel:f,maxHeadingLevel:g}},[t,s,f,g])),(0,h.jsx)(m,{toc:y,className:n,linkClassName:t,...u})}},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>s});var o=t(6540);const i={},a=o.createContext(i);function r(e){const n=o.useContext(a);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),o.createElement(a.Provider,{value:n},e.children)}}}]);